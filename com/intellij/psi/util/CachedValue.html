<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (9.0.4) on Fri Mar 13 21:13:31 UTC 2020 -->
<title>CachedValue (Unofficial IntelliJ Community Edition API docs)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="date" content="2020-03-13">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../jquery/jquery-1.10.2.js"></script>
<script type="text/javascript" src="../../../../jquery/jquery-ui.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="CachedValue (Unofficial IntelliJ Community Edition API docs)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":6,"i1":6,"i2":6,"i3":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../";loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../com/intellij/psi/util/AccessModifier.html" title="enum in com.intellij.psi.util"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../com/intellij/psi/util/CachedValueProfiler.html" title="class in com.intellij.psi.util"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?com/intellij/psi/util/CachedValue.html" target="_top">Frames</a></li>
<li><a href="CachedValue.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><span>SEARCH:&nbsp;</span>
<input type="text" id="search" value=" " disabled="disabled">
<input type="reset" id="reset" value=" " disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle"><span class="packageLabelInClass">Package</span>&nbsp;<a href="../../../../com/intellij/psi/util/package-summary.html" target="classFrame">com.intellij.psi.util</a></div>
<h2 title="Interface CachedValue" class="title">Interface CachedValue&lt;T&gt;</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>T</code> - The type of the computation result.</dd>
</dl>
<dl>
<dt>All Known Implementing Classes:</dt>
<dd><a href="../../../../com/intellij/util/CachedValueImpl.html" title="class in com.intellij.util">CachedValueImpl</a>, <a href="../../../../com/intellij/psi/impl/PsiCachedValueImpl.html" title="class in com.intellij.psi.impl">PsiCachedValueImpl</a></dd>
</dl>
<hr>
<br>
<pre>public interface <span class="typeNameLabel">CachedValue&lt;T&gt;</span></pre>
<div class="block">A wrapper object that holds a computation (<a href="../../../../com/intellij/psi/util/CachedValue.html#getValueProvider--"><code>getValueProvider()</code></a>) and caches the result of the computation.
 The recommended way of creation is to use one of <a href="../../../../com/intellij/psi/util/CachedValuesManager.html#getCachedValue-com.intellij.openapi.util.UserDataHolder-com.intellij.openapi.util.Key-com.intellij.psi.util.CachedValueProvider-boolean-"><code>CachedValuesManager.getCachedValue(com.intellij.openapi.util.UserDataHolder, com.intellij.openapi.util.Key&lt;com.intellij.psi.util.CachedValue&lt;T&gt;&gt;, com.intellij.psi.util.CachedValueProvider&lt;T&gt;, boolean)</code></a> methods.<p></p>

 When <a href="../../../../com/intellij/psi/util/CachedValue.html#getValue--"><code>getValue()</code></a> is invoked the first time, the computation is run and its result is returned and remembered internally.
 In subsequent invocations, the result will be reused to avoid running the same code again and again.<p/>

 The computation will be re-run in the following circumstances:
 <ol>
   <li>Garbage collector collects the result cached internally (it's kept via a <code>SoftReference</code>).
   <li>The IDE determines that cached value is outdated because some its dependencies are changed. See
   <a href="../../../../com/intellij/psi/util/CachedValueProvider.Result.html#getDependencyItems--"><code>CachedValueProvider.Result.getDependencyItems()</code></a>
 </ol>

 The implementation is thread-safe but not atomic, i.e. if several threads request the cached value simultaneously, the computation may
 be run concurrently on more than one thread. Due to this and unpredictable garbage collection,
 cached value providers shouldn't have side effects.<p></p>

 <b>Result equivalence</b>: CachedValue might return a different result even if the previous one
 is still reachable and not garbage-collected, and dependencies haven't changed. Therefore CachedValue results
 should be equivalent and interchangeable if they're called multiple times. Examples:
 <ul>
   <li>If PSI declarations are cached, <code>#equals</code> or at least <a href="../../../../com/intellij/psi/PsiManager.html#areElementsEquivalent-com.intellij.psi.PsiElement-com.intellij.psi.PsiElement-"><code>PsiManager.areElementsEquivalent(com.intellij.psi.PsiElement, com.intellij.psi.PsiElement)</code></a>
   should hold for results from the same CachedValue.</li>
   <li><a href="../../../../com/intellij/psi/ResolveResult.html" title="interface in com.intellij.psi"><code>ResolveResult</code></a> objects should have equivalent <code>getElement()</code> values.</li>
   <li>Cached arrays or lists should have the same number of elements, and they also should be equivalent and come in the same order.</li>
   <li>If the result object's class has a meaningful <code>#equals</code> method, it should hold.</li>
 </ul>
 This is enforced at runtime by occasional checks in <code>com.intellij.util.IdempotenceChecker#checkEquivalence(Object, Object, Class)</code>.
 See that method's documentation for further information and advice, when a failure happens.<p></p>

 <b>Context-independence</b>: if you store the CachedValue in a field or user data of some object <code>X</code>, then its <a href="../../../../com/intellij/psi/util/CachedValueProvider.html" title="interface in com.intellij.psi.util"><code>CachedValueProvider</code></a>
 may only depend on X and parts of global system state that don't change while <code>X</code> is alive and valid (e.g. application/project components/services).
 Otherwise re-invoking the CachedValueProvider after invalidation would use outdated data and produce incorrect results,
 possibly causing exceptions in places far, far away. In particular, the provider may not capture:
 <ul>
   <li>Parameters of a method where CachedValue is created, except for <code>X</code> itself. Example:
   <pre>
   PsiElement resolve(PsiElement e, boolean incompleteCode) {
     return CachedValuesManager.getCachedValue(e, () -> doResolve(e, incompleteCode)); // WRONG!!!
   }
   </pre>

   </li>
   <li>"this" object creating the CachedValue, if <code>X</code> can outlive it,
   or if there can be several non-equivalent instances of "this"-object's class all creating a cached value for the same place</li>
   <li>Thread-locals at the moment of creation. If you use them (either directly or via <a href="../../../../com/intellij/openapi/util/RecursionGuard.html#currentStack--"><code>RecursionGuard.currentStack()</code></a>),
   please try not to. If you really have to, also use <a href="../../../../com/intellij/openapi/util/RecursionGuard.html#prohibitResultCaching-Key-"><code>RecursionGuard.prohibitResultCaching(Object)</code></a>
   to ensure values depending on unstable data won't be cached.</li>
   <li>PSI elements around <code>X</code>, when <code>X</code> is a <a href="../../../../com/intellij/psi/PsiElement.html" title="interface in com.intellij.psi"><code>PsiElement</code></a> itself,
   as they can change during the lifetime of that PSI element. Example:
   <pre>
   PsiMethod[] methods = psiClass.getMethods();
   return CachedValuesManager.getCachedValue(psiClass, () -> calculateSomeResult(methods)); // WRONG!!!
   </pre>
   </ul>
 </ul>
 This is enforced at runtime by occasional checks in <code>CachedValueStabilityChecker</code>.
 See that class's documentation for further information and advice, when a failure happens.<p></p>

 <b>Recursion prevention</b>: The same cached value provider can be re-entered recursively on the same thread,
 if the computation is inherently cyclic. Note that this is likely to result in <code>StackOverflowError</code>,
 so avoid such situations at all cost. If there's no other way, use
 <a href="../../../../com/intellij/openapi/util/RecursionManager.html#doPreventingRecursion-java.lang.Object-boolean-com.intellij.openapi.util.Computable-"><code>RecursionManager.doPreventingRecursion(java.lang.Object, boolean, com.intellij.openapi.util.Computable&lt;T&gt;)</code></a> instead of custom thread-locals to help get out of the endless loop. Please ensure this call happens inside
 the <a href="../../../../com/intellij/psi/util/CachedValueProvider.html" title="interface in com.intellij.psi.util"><code>CachedValueProvider</code></a>, not outside <a href="../../../../com/intellij/psi/util/CachedValue.html#getValue--"><code>getValue()</code></a> call. Otherwise you might get no caching at all, because
 CachedValue uses <code>RecursionGuard.StackStamp#mayCacheNow()</code> to prevent caching incomplete values, and even the top-level
 call would be considered incomplete if it happens inside <code>doPreventingRecursion</code>.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../com/intellij/psi/util/CachedValueProvider.html" title="interface in com.intellij.psi.util"><code>CachedValueProvider</code></a>, 
<a href="../../../../com/intellij/psi/util/CachedValuesManager.html" title="class in com.intellij.psi.util"><code>CachedValuesManager</code></a></dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code><a href="../../../../com/intellij/openapi/util/Getter.html" title="interface in com.intellij.openapi.util">Getter</a>&lt;<a href="../../../../com/intellij/psi/util/CachedValue.html" title="type parameter in CachedValue">T</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/intellij/psi/util/CachedValue.html#getUpToDateOrNull--">getUpToDateOrNull</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code><a href="../../../../com/intellij/psi/util/CachedValue.html" title="type parameter in CachedValue">T</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/intellij/psi/util/CachedValue.html#getValue--">getValue</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code><a href="../../../../com/intellij/psi/util/CachedValueProvider.html" title="interface in com.intellij.psi.util">CachedValueProvider</a>&lt;<a href="../../../../com/intellij/psi/util/CachedValue.html" title="type parameter in CachedValue">T</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/intellij/psi/util/CachedValue.html#getValueProvider--">getValueProvider</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/intellij/psi/util/CachedValue.html#hasUpToDateValue--">hasUpToDateValue</a></span>()</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getValue--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getValue</h4>
<pre><a href="../../../../com/intellij/psi/util/CachedValue.html" title="type parameter in CachedValue">T</a>&nbsp;getValue()</pre>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>cached value if it's already computed and not outdated, newly computed value otherwise</dd>
</dl>
</li>
</ul>
<a name="getValueProvider--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getValueProvider</h4>
<pre><a href="../../../../com/intellij/psi/util/CachedValueProvider.html" title="interface in com.intellij.psi.util">CachedValueProvider</a>&lt;<a href="../../../../com/intellij/psi/util/CachedValue.html" title="type parameter in CachedValue">T</a>&gt;&nbsp;getValueProvider()</pre>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the object calculating the value to cache</dd>
</dl>
</li>
</ul>
<a name="hasUpToDateValue--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>hasUpToDateValue</h4>
<pre>boolean&nbsp;hasUpToDateValue()</pre>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>whether there is a cached result inside this object and it's not outdated</dd>
</dl>
</li>
</ul>
<a name="getUpToDateOrNull--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getUpToDateOrNull</h4>
<pre><a href="../../../../com/intellij/openapi/util/Getter.html" title="interface in com.intellij.openapi.util">Getter</a>&lt;<a href="../../../../com/intellij/psi/util/CachedValue.html" title="type parameter in CachedValue">T</a>&gt;&nbsp;getUpToDateOrNull()</pre>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>if <a href="../../../../com/intellij/psi/util/CachedValue.html#hasUpToDateValue--"><code>hasUpToDateValue()</code></a>, then a wrapper around the cached value, otherwise <code>null</code>.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><p>This is <b>unofficial</b> documentation and <b>not affiliated with Jetbrains s.r.o.</b> at all. We can <b>not guarantee the correctness</b> of this documentation.</p></div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../com/intellij/psi/util/AccessModifier.html" title="enum in com.intellij.psi.util"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../com/intellij/psi/util/CachedValueProfiler.html" title="class in com.intellij.psi.util"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?com/intellij/psi/util/CachedValue.html" target="_top">Frames</a></li>
<li><a href="CachedValue.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
