<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (9.0.4) on Fri Mar 13 21:16:18 UTC 2020 -->
<title>AsyncFileListener (Unofficial IntelliJ Community Edition API docs)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="date" content="2020-03-13">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../jquery/jquery-1.10.2.js"></script>
<script type="text/javascript" src="../../../../jquery/jquery-ui.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="AsyncFileListener (Unofficial IntelliJ Community Edition API docs)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../";loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../../../com/intellij/openapi/vfs/AsyncFileListener.ChangeApplier.html" title="interface in com.intellij.openapi.vfs"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?com/intellij/openapi/vfs/AsyncFileListener.html" target="_top">Frames</a></li>
<li><a href="AsyncFileListener.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><span>SEARCH:&nbsp;</span>
<input type="text" id="search" value=" " disabled="disabled">
<input type="reset" id="reset" value=" " disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle"><span class="packageLabelInClass">Package</span>&nbsp;<a href="../../../../com/intellij/openapi/vfs/package-summary.html" target="classFrame">com.intellij.openapi.vfs</a></div>
<h2 title="Interface AsyncFileListener" class="title">Interface AsyncFileListener</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Known Implementing Classes:</dt>
<dd><a href="../../../../com/intellij/util/indexing/ChangedFilesCollector.html" title="class in com.intellij.util.indexing">ChangedFilesCollector</a>, <a href="../../../../com/intellij/compiler/backwardRefs/DirtyScopeHolder.html" title="class in com.intellij.compiler.backwardRefs">DirtyScopeHolder</a>, <a href="../../../../com/intellij/compiler/impl/TranslatingCompilerFilesMonitor.html" title="class in com.intellij.compiler.impl">TranslatingCompilerFilesMonitor</a>, <a href="../../../../com/intellij/openapi/vcs/changes/VcsDirtyScopeVfsListener.html" title="class in com.intellij.openapi.vcs.changes">VcsDirtyScopeVfsListener</a></dd>
</dl>
<hr>
<br>
<pre>public interface <span class="typeNameLabel">AsyncFileListener</span></pre>
<div class="block">An alternative to <a href="../../../../com/intellij/openapi/vfs/newvfs/BulkFileListener.html" title="interface in com.intellij.openapi.vfs.newvfs"><code>BulkFileListener</code></a> that allows
 for moving parts of VFS event processing to background thread and thus reduce the duration
 of UI freezes. Asynchronous listeners should preferably be registered as "vfs.asyncListener" extensions.
 If that's too inconvenient, manual registration via <a href="../../../../com/intellij/openapi/vfs/VirtualFileManager.html#addAsyncFileListener-com.intellij.openapi.vfs.AsyncFileListener-com.intellij.openapi.Disposable-"><code>VirtualFileManager.addAsyncFileListener(com.intellij.openapi.vfs.AsyncFileListener, com.intellij.openapi.Disposable)</code></a> is possible.<p></p>

 <h3>Migration of synchronous listeners:</h3>

 Synchronous listeners have two flavours: "before" and "after"; observing the state of the system before and after a VFS change, respectively.
 Since asynchronous listeners are executed before applying VFS events, they're more easily suited to "before" event processing. Note that
 not all synchronous listeners need to be migrated, only those that might take noticeable time.<p></p>

 To migrate a "before"-handler, you need to split the listener into two parts: one that analyzes the events but has no side effects,
 and one which actually modifies some other subsystem's state based on these events. The first part then goes into <a href="../../../../com/intellij/openapi/vfs/AsyncFileListener.html#prepareChange-java.util.List-"><code>prepareChange(java.util.List&lt;? extends com.intellij.openapi.vfs.newvfs.events.VFileEvent&gt;)</code></a>,
 and the second one into <a href="../../../../com/intellij/openapi/vfs/AsyncFileListener.ChangeApplier.html#beforeVfsChange--"><code>AsyncFileListener.ChangeApplier.beforeVfsChange()</code></a>. Please ensure that the ordering of events
 (if it's important) isn't lost during this splitting, and that your listener can handle several events about the same file.
 If your listener depends on state that's not synchronized using read-write actions, be aware that this state can be changed
 during <a href="../../../../com/intellij/openapi/vfs/AsyncFileListener.html#prepareChange-java.util.List-"><code>prepareChange(java.util.List&lt;? extends com.intellij.openapi.vfs.newvfs.events.VFileEvent&gt;)</code></a> or before <a href="../../../../com/intellij/openapi/vfs/AsyncFileListener.ChangeApplier.html#beforeVfsChange--"><code>AsyncFileListener.ChangeApplier.beforeVfsChange()</code></a>.
 Take care to synchronize the state properly and handle its changes.<p></p>

 The "after"-part is more complicated, as it might need to observe the state of the whole system (e.g. VFS, project model, PSI) after
 the file system is changed. So moving these computations into "before"-part might not be straightforward. It's still possible sometimes:
 e.g. if you only check for changed file names, or whether some file (non-directory) with a specific name is created under project's roots.
 In this case the check can go into <a href="../../../../com/intellij/openapi/vfs/AsyncFileListener.html#prepareChange-java.util.List-"><code>prepareChange(java.util.List&lt;? extends com.intellij.openapi.vfs.newvfs.events.VFileEvent&gt;)</code></a>, and the action based on it &mdash; into <a href="../../../../com/intellij/openapi/vfs/AsyncFileListener.ChangeApplier.html#afterVfsChange--"><code>AsyncFileListener.ChangeApplier.afterVfsChange()</code></a>.
 <p></p>

 When you migrate a listener with both "before" and "after" parts, you can try to just move the whole "after"-processing into
 <a href="../../../../com/intellij/openapi/vfs/AsyncFileListener.ChangeApplier.html#afterVfsChange--"><code>AsyncFileListener.ChangeApplier.afterVfsChange()</code></a>. But make it as fast as possible to shorten the UI freezes.<p></p>

 If possible, consider moving heavy processing into background threads and/or performing it lazily.
 There's no general solution, each "after" event processing should be evaluated separately considering the needs and contracts
 of each specific subsystem it serves. Note that it'll likely need a consistent model of the world, probably with the help of
 <a href="../../../../com/intellij/openapi/application/ReadAction.html#nonBlocking-java.lang.Runnable-"><code>ReadAction.nonBlocking(java.lang.Runnable)</code></a> (and note that other changes might happen after yours, and
 the state of the system can change when your asynchronous handler starts). This might also
 introduce a discrepancy in the world when the VFS is already changed but other subsystems aren't, and this discrepancy
 should be made as explicit as possible.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Interface and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/intellij/openapi/vfs/AsyncFileListener.ChangeApplier.html" title="interface in com.intellij.openapi.vfs">AsyncFileListener.ChangeApplier</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code><a href="../../../../com/intellij/openapi/vfs/AsyncFileListener.ChangeApplier.html" title="interface in com.intellij.openapi.vfs">AsyncFileListener.ChangeApplier</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/intellij/openapi/vfs/AsyncFileListener.html#prepareChange-java.util.List-">prepareChange</a></span>(java.util.List&lt;? extends <a href="../../../../com/intellij/openapi/vfs/newvfs/events/VFileEvent.html" title="class in com.intellij.openapi.vfs.newvfs.events">VFileEvent</a>&gt;&nbsp;events)</code>
<div class="block">Called (possibly on a background thread) when a batch of VFS events is ready to be fired.</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="prepareChange-java.util.List-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>prepareChange</h4>
<pre><a href="../../../../com/intellij/openapi/vfs/AsyncFileListener.ChangeApplier.html" title="interface in com.intellij.openapi.vfs">AsyncFileListener.ChangeApplier</a>&nbsp;prepareChange(java.util.List&lt;? extends <a href="../../../../com/intellij/openapi/vfs/newvfs/events/VFileEvent.html" title="class in com.intellij.openapi.vfs.newvfs.events">VFileEvent</a>&gt;&nbsp;events)</pre>
<div class="block">Called (possibly on a background thread) when a batch of VFS events is ready to be fired.
 This method should not have side effects and should guarantee its cancellability by calling
 <a href="../../../../com/intellij/openapi/progress/ProgressManager.html#checkCanceled--"><code>ProgressManager.checkCanceled()</code></a> often enough.<p></p>
 <p>
 Note that this listener can only observe the state of the system before VFS events, and so
 it can't work with anything that would be after them, e.g. there will be no file in
 <a href="../../../../com/intellij/openapi/vfs/newvfs/events/VFileCreateEvent.html" title="class in com.intellij.openapi.vfs.newvfs.events"><code>VFileCreateEvent</code></a>, <a href="../../../../com/intellij/openapi/roots/FileIndexFacade.html" title="class in com.intellij.openapi.roots"><code>FileIndexFacade</code></a>
 won't know anything about the updated state after VFS change, and so on.
 <p>
 Note that the events posted passed might differ from the ones passed into <a href="../../../../com/intellij/openapi/vfs/newvfs/BulkFileListener.html" title="interface in com.intellij.openapi.vfs.newvfs"><code>BulkFileListener</code></a>.
 In particular, there may occasionally be several events about the same file (e.g deletion and then creation, or creation and
 then deletion of the file's parent). Hence the order of events is significant. Implementations should be prepared to such situations.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a ChangeApplier object to be called inside write action before/after the passed events
 are finally applied to VFS</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><p>This is <b>unofficial</b> documentation and <b>not affiliated with Jetbrains s.r.o.</b> at all. We can <b>not guarantee the correctness</b> of this documentation.</p></div>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../../../com/intellij/openapi/vfs/AsyncFileListener.ChangeApplier.html" title="interface in com.intellij.openapi.vfs"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?com/intellij/openapi/vfs/AsyncFileListener.html" target="_top">Frames</a></li>
<li><a href="AsyncFileListener.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
